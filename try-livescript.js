// Generated by LiveScript 1.2.0
(function(){
  var toString$ = {}.toString;
  $(function(){
    var ref$, run, compile, any, history, lsc, preScript, noHistory, commandHandled;
    ref$ = require('LiveScript'), run = ref$.run, compile = ref$.compile;
    any = require('prelude-ls').any;
    history = [];
    lsc = $('#ls-console');
    window.lscConsole = lsc.console({
      promptLabel: '> ',
      commandValidate: function(line){
        return line !== '';
      },
      commandHandle: function(line){
        var lines, result, className, resultType, re, ex;
        try {
          lines = (history.concat([preScript])).reduce(function(acc, a){
            return acc + "\n_ = " + a;
          }, "");
          line = line.trim();
          result = eval(compile("<- (do)\n" + lines + "\n" + line, {
            bare: true
          }));
          if ("1.1.1" === result.VERSION) {
            result = "{prelude}";
            className = 'type';
          } else {
            resultType = toString$.call(result).slice(8, -1);
            if (any((function(it){
              return resultType === it;
            }))(
            ['Array', 'Object', 'Number', 'String', 'Boolean'])) {
              className = 'value';
              re = /function.*\((.*)\).*/i;
              result = JSON.stringify(result, function(k, v){
                var ref$, _, args;
                if ('Function' === toString$.call(v).slice(8, -1)) {
                  className = 'type';
                  if ((ref$ = re.exec(v.toString())) != null) {
                    _ = ref$[0], args = ref$[1];
                  }
                  if (!args && !(args != null && args.trim)) {
                    debugger;
                  }
                  return "(" + args.trim() + ") -> ...";
                }
                return v;
              });
            } else {
              result = result.toString();
              className = 'type';
            }
          }
          if (!noHistory) {
            if (!!preScript) {
              history.push(preScript);
            }
            history.push(line);
          }
        } catch (e$) {
          ex = e$;
          result = ex.message;
          className = 'error';
        }
        commandHandled();
        return [{
          msg: result,
          className: "jquery-console-message-" + className
        }];
      },
      autofocus: true,
      animateScroll: true,
      promptHistory: true
    });
    window.lscReset = function(){
      history = [];
      return lscConsole.reset();
    };
    preScript = null;
    noHistory = false;
    window.promptText = function(xPre, xNoHistory, s){
      if (!!xPre) {
        preScript = xPre;
      }
      noHistory = xNoHistory;
      return lscConsole.promptText(s);
    };
    commandHandled = function(){
      preScript = null;
      return noHistory = false;
    };
    return $('.prompt').each(function(){
      return $(this).click(function(){
        var isPre, xPre, xNoHistory;
        isPre = 'PRE' === this.tagName;
        xPre = $(this).attr('x-pre');
        xNoHistory = "String" === toString$.call($(this).attr('x-no-history')).slice(8, -1);
        promptText(xPre, xNoHistory, (isPre ? "\n" : "") + $(this).text());
        return lscConsole.focus();
      });
    });
  });
}).call(this);
